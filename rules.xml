<?xml version="1.0" encoding="UTF-8"?>
<ruleset>
    <server-settings>
        <server>localhost:9905</server>
        <execute-pyref>false</execute-pyref>
        <dev-allow>localhost</dev-allow>
        <dev-user username="admin" password="admin" />
        <display-local-files>false</display-local-files>
        <edit-local-files>false</edit-local-files>
    </server-settings>

    <proxy keep-host="1" path="/static" class="static">
        <dest href="{here}/static/" />
    </proxy>

    <!-- proxy path="/" class="plone">
        <dest href="http://localhost:9105/VirtualHostBase/http/sfd.at:80/sfd/sfd.at/VirtualHostRoot/" />
    </proxy -->

    <proxy path="/" class="plone">
        <dest href="http://localhost:8080/VirtualHostBase/http/localhost:9905/sfd/sfd.at/VirtualHostRoot/" />
    </proxy>

    <match path="regex:^/$" abort="1" />  <!-- sfdintro -->
    <match path="regex:.*contenthistorypopup.*" abort="1" />  <!-- popupforms.js corrections -->
    <match path="regex:^/portal_javascripts/.*" abort="1" />  <!-- TinyMCE -->
    <match path="regex:.*/themes/advanced/.*" abort="1" />  <!-- TinyMCE -->
    <match path="regex:.*/plugins/.*" abort="1" />  <!-- class="popup" TinyMCE -->

    <rule class="popup">
        <theme href="/static/editor-popup.html" />
        <prepend content='/html/head/script' theme='/html/head/link' />
        <prepend content="/html/head/link" theme="/html/head/link" />
        <prepend content="/html/head/style" theme="/html/head/link" />
        <replace content="/html/head/body" theme="/html/head/body" />
    </rule>


    <!-- ====================================================== -->
    <!-- Rules                                                  -->
    <!-- ====================================================== -->

    <rule class="plone" suppress-standard="1">
        <theme href="/static/template.html" />

    <drop theme="/html/head/meta" />
    <drop content="link[href *= 'style_screen.css']" />

    <replace content="/html/head/title" theme="/html/head/title" />
    <append content="/html/head/meta" theme="children:/html/head" />
    <append content="/html/head/base" theme="children:/html/head" />
    <append content="link[rel *= 'kss-base-url']" theme="children:/html/head" />

    <!-- Add in the Plone-created CSS, KSS and JS in addition to the static ones -->
    <prepend content="link[href *= 'member']" theme="/html/head/link" />
    <prepend content="link[href *= 'public']" theme="/html/head/link" />
    <prepend content="link[href *= 'ploneKss']" theme="/html/head/link" />
    <prepend content="link[href *= 'slimbox']" theme="/html/head/link" />
    <prepend content="/html/head/style" theme="/html/head/link" />
    <prepend content="link[rel *= 'kinetic-stylesheet']" theme="/html/head/link" />
    <prepend content="/html/head/script" theme="/html/head/link" />

    <append content="link[rel = 'author']" theme="children:/html/head" />
    <append content="link[rel = 'home']" theme="children:/html/head" />
    <append content="link[rel = 'contents']" theme="children:/html/head" />
    <append content="link[rel = 'search']" theme="children:/html/head" />

    <!-- ====================================================== -->
    <!-- Header                                                 -->
    <!-- ====================================================== -->

    <!-- Accessibility -->
    <replace content='#portal-header > p.hiddenStructure' theme='#sfd-header > a.hiddenStructure' />

    <!-- Set correct Link for the logo -->
    <replace content='attributes(href,accesskey,title):#portal-logo' theme='attributes:#sfd-logo a' />

    <!-- Search box -->
    <!-- drop content="#portal-searchbox input.searchButton" /-->
    <drop content="#portal-searchbox div.searchSection" />
    <drop content="tag:.LSBox" />
    <replace content="children:#portal-searchbox" theme="#seachform" />

    <!-- metamenu -->
    <replace content="#portal-siteactions" theme="children:#sfd-metamenu" />

    <!-- ====================================================== -->
    <!-- Portlets and Viewlets                                  -->
    <!-- ====================================================== -->

    <!-- Portlets Prepare -->
    <drop theme="children:#sfd-menu" />
    <drop content="tag:div[id *= 'portletwrapper']" />
    <drop content="span.portletTopLeft" />
    <drop content="span.portletTopRight" />

    <!-- Vertical Navigation -->
    <drop content=".portletNavigationTree .portletItem li img" />
    <replace content="children:.portletNavigationTree .portletItem" theme="children:#sfd-menu" />
    <drop content="dl.portletNavigationTree" />

    <!-- append languageselector to navigation -->
    <!-- drop content="ul#portal-languageselector li.currentLanguage" / -->
    <!-- append content="children:#portal-languageselector" theme="children:#sfd-menu .navTree" /-->

    <!-- Portlets Prepare -->
    <append content="children:#portal-column-one" theme="children:#sfd-menu" />


    <!-- ====================================================== -->
    <!-- Main Content                                           -->
    <!-- ====================================================== -->

    <!-- replace content="#grak-navigator" theme="#grak-navigator" / -->
    <drop theme="children:#sfd-content" />
    <append content="attributes(class):div.documentEditable" theme="attributes(class):#sfd-content" />
    <append content="#content h1" theme="children:#sfd-content" />
    <append content=".portalMessage" theme="children:#sfd-content" />
    <append content="#portal-breadcrumbs" theme="children:#sfd-content" />
    <append content="#plone-document-byline" theme="children:#sfd-content" />
    <append content="#edit-bar" theme="children:#sfd-content" />
    <append content="#content" theme="children:#sfd-content" />

    <!-- append content="div[id ^= 'pb_']" theme="#sfd-footer" />
    <append content="div[id ^= 'lb']" theme="#sfd-footer" / -->

</rule>
</ruleset>
