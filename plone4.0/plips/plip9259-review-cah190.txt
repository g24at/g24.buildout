PLIP 9259: Group dashboards
===========================

PLIP ticket: https://dev.plone.org/plone/ticket/9259

Guest review by Craig Haynal (cah190@psu.edu, cah190 on irc)

PLIP was reviewed on Mac OS X 10.6 using python 2.6.2 and Camino 1.6.9.

Review steps
------------

 - Ran buildout using the plip9259-group-dashboards.cfg file.

 - Ran tests for plone.app.layout and plone.app.portlets

 - Visually inspected the code
 
 - Started Zope, created new Plone site, assigned new permissions to appropriate
roles, created new group, and manipulated group dashboard portlets

 - Tested @@manage-group-dashboard view against a non-existent group
 
Notes and observations
---------------------- 

* The group portlets function as described.

* The addition of the "Portlets: View dashboard" permission is very useful, as
it allows for read-only user dashboards.

* I found the "Portlets: Manage group portlets" permission to be misleading.  By
its name I expected that permission to allow a user to manage the portlets for
their own groups, however it grants the ability to manage the portlets for all
groups.

I would think that the existing permission "Portlets: Manage portlets" should
allow for the editing of all group portlets and that "Portlets: Manage group
portlets" should either be eliminated or repurposed to include a group
membership test, so that editing permissions for editing group dashboards can be
delegated.  As it stands now, it duplicates the existing permission's
functionality.

* The to do list indicates "Portlets: View dashboard" should be assigned to
Authenticated Users, however it may be more appropriate to assign this
permission to Member.

* The Group Members and Group Properties tabs have "Edit group dashboard
portlets" links, however the @@manage-group-portlets and
@@manage-group-dashboard views have links to switch between these two views in
that space, which seems inconsistent.

* Splitting the Group Portlets and Group Dashboard Portlets into separate tabs
would make this functionality more visible.  Right now the Group Dashboard
functionality seems hidden.

* The code looks clean and appropriate tests have been added.

Conclusions 
-----------

This is great functionality, but I think it could use a few tweaks.  In
particular I would like to see the Group Dashboard Portlets view be its own tab
so group dashboards are more visible.  The Group Dashboard Portlets management
view should be more consistent with the existing group management tabs.  And
the Manage Group Portlets permission should be removed (or repurposed as above)
in favor of using the existing "Portlets: Manage Portlets" permission.

Merge Review
------------

All of the inconsistencies with Plone UI and permissions have been addressed.
The Group Dashboard Portlets still behave as described and all tests pass.
The integration is seamless and everything looks great at this point.

The only issue I ran into when re-reviewing this PLIP was that the template
changes to prefs_group_details and prefs_group_members mentioned in the
Post-merge activities didn't work until I changed "key=${request/key}"
to "${groupkeyquery}" as per:

      <li>
        <a href=""
           tal:attributes="href string:${portal_url}/@@manage-group-dashboard?${groupkeyquery}"
           i18n:translate="label_group_dashboard">Group Dashboard</a>
      </li>

I recommend this PLIP be merged (+1).
